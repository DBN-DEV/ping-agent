syntax = "proto3";

option go_package = ".;grpc";
package controller_grpc;

message CommandRequest {
  uint32 AgentID = 1;
  string Version = 2;
}

message GrpcPingCommand {
  string IP = 1;
  uint32 TimeoutMS = 2;
  uint32 IntervalMS = 3;
}

message PingCommandsResponse {
  string Version = 1;
  repeated GrpcPingCommand PingCommands = 2;
}

message GrpcTcpPingCommand {
  string Target = 1;
  uint32 TimeoutMS = 2;
  uint32 IntervalMS = 3;
}

message TcpPingCommandResponse {
  string Version = 1;
  repeated GrpcTcpPingCommand TcpPingCommands = 2;
}

message FpingCommandResponse {
  string Version = 1;
  repeated string IPs = 2;
  uint32 TimeoutMS = 3;
}

message MtrCommandResponse {
  string Version = 1;
  string IP = 2;
  uint32 HopLimit = 3;
  uint32 TimeoutMS = 4;
}

service Controller {
  rpc GetTcpPingCommand (CommandRequest) returns (stream PingCommandsResponse);
  rpc GetPingCommand (CommandRequest) returns (stream TcpPingCommandResponse);
  rpc GetFpingCommand (CommandRequest) returns (stream FpingCommandResponse);
  rpc GetMtrCommand (CommandRequest) returns (stream MtrCommandResponse);
}
